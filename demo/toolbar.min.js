(function(e,t){"use strict";var n=function(e,t){return new n.fn.init(e,t)};return n.fn=n.prototype={constructor:n,init:function(e,t){if(!e)return e;if(typeof e=="string"){e=document.querySelector(e);if(!e)return e}"length"in e&&(e=e[0]);var n=this,r=n.settings=MBP.extend({},n.settings,t);return n.support=MBP.buildVendorNames(),n.support.transitionEnd=n.eventNames[n.support.transition]||null,n.setupToolbarElements(e,r),n.applyTransitionEnd(),n.setupOritentationChange(),n.setToolbarMenu(r.menuItems),this},version:"0.0.3",toolbar:t,topMenu:t,subMenu:t,expandTarget:t,hasMouse:"",touchType:"",touchStart:"",div:t,support:{},eventNames:{MozTransition:"transitionend",OTransition:"oTransitionEnd",WebkitTransition:"webkitTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"},setToolbarMenu:function(e){var t=0,n="",r="",i=this,s=i.settings;i.expandToolbar(!0),i.topMenu.innerHTML="",i.subMenu.innerHTML="";if(e.topMenu)for(t=0;t<e.topMenu.length;t++)n+=i.parseMenuItem(e.topMenu[t],s.toolbarItemTemplate);if(e.subMenu)for(t=0;t<e.subMenu.length;t++)r+=i.parseMenuItem(e.subMenu[t],s.subMenuItemTemplate);t=e.topMenu.length,n===""&&r===""?i.toolbar.style.display="none":(i.toolbar.style.display="block",n+="<div class='expand-toolbar'>...</div>",t++,i.topMenu.innerHTML=n,i.subMenu.innerHTML=r,i.setIconWidth(t),i.expandTarget=i.toolbar.querySelector(s.expandTargetSelector),i.setupExpand(),i.bindCallBacks(e))},parseMenuItem:function(e,t){return t.replace("{{title}}",e.title).replace("{{iconClass}}",e.iconClass)},setIconWidth:function(t){var n=this.settings,r=document.querySelector(n.topMenuItemSelector).clientWidth,i=e.innerWidth,s=Math.floor((i-t*r)/(t*2)/i*100),o=document.querySelectorAll(n.topMenuItemSelector),u=document.querySelector(n.topMenuItemSelector);for(t=0;t<o.length;t++)o[t].style.marginRight=s+"%",o[t].style.marginLeft=s+"%";u&&(u.style.marginRight=s+"%",u.style.marginLeft=s+"%")},bindCallBacks:function(e){var t=0,n=this,r,i;for(t=0;t<e.topMenu.length;t++)r=e.topMenu[t],n.bindTapEvent(document.querySelector("."+r.iconClass),r.callback);for(t=0;t<e.subMenu.length;t++)r=e.subMenu[t],n.bindTapEvent(document.querySelector("."+r.iconClass),r.callback)},buildTransitionValue:function(e){var t=this.settings;return e+" "+t.expandSpeed+"ms "+t.easing},setupToolbarElements:function(e,t){var n=this;n.toolbar=e,n.topMenu=n.toolbar.querySelector(t.topMenuSelector),n.subMenu=n.toolbar.querySelector(t.subMenuSelector)},applyTransitionEnd:function(){var e=this;e.toolbar.addEventListener(e.support.transitionEnd,function(t){e.transitionEnd(t)})},transitionEnd:function(e){this.toolbar.style[this.support.transition]=""},setupTouch:function(){var t=this;t.touchType=e.navigator.msPointerEnabled?"pointer":"ontouchstart"in e?"touch":"mouse",t.hasMouse="ontouchstart"in e&&"onmousedown"in e,t.touchStart=this.touchType==="pointer"?"MSPointerDown":this.touchType==="touch"?"touchstart":"mousedown"},setupExpand:function(){var e=this;e.setupTouch(),e.bindTapEvent(e.expandTarget,function(t){t.preventDefault(),e.expandToolbar()})},bindTapEvent:function(e,t){var n=this;if(!e)return;e.addEventListener(n.touchStart,function(e){t.call(n,e)}),n.hasMouse&&e.addEventListener("mousedown",function(e){t.call(n,e)})},expandToolbar:function(e){var n=this,r=n.settings,i=n.toolbar,s,o;if(e===!0&&(i.expanded===t||i.expanded===!1))return;i.orientation==="portrait"?i.style[n.support.transition]=n.buildTransitionValue("height"):i.style[n.support.transition]=n.buildTransitionValue("width"),i.expanded?(i.orientation==="portrait"?i.style.height=r.minHeight+"px":i.style.width=r.minWidth+"px",i.expanded=!1):(n.toolbar.orientation==="portrait"?(s=n.topMenu!=t?n.topMenu.getBoundingClientRect():{height:"0px",width:"0px"},o=n.subMenu!=t?n.subMenu.getBoundingClientRect():{height:"0px",width:"0px"},i.style.height=s.height+o.height+"px"):i.style.width=r.expandWidth+"px",i.expanded=!0)},setupOritentationChange:function(){var t=this,n=t.toolbar,r="onorientationchange"in e,i=r?"orientationchange":"resize";n.orientation=e.innerWidth>e.innerHeight?"landscape":"portrait",e.addEventListener(i,function(){n.orientation=e.innerWidth>e.innerHeight?"landscape":"portrait",n.orientation==="landscape"?(n.style.height=e.innerHeight+"px",n.style.width="42px"):(n.style.height="35px",n.style.width=e.innerWidth+"px")},!1)},settings:{minHeight:35,minWidth:42,expandWidth:200,mainSelector:".toolbar",topMenuSelector:".toolbar-top-menu",subMenuSelector:".toolbar-sub-menu",expandTargetSelector:".expand-toolbar",topMenuItemSelector:".toolbar-item",menuItems:{topMenu:[],subMenu:[]},toolbarItemTemplate:"<div class='toolbar-item'><div class='toolbar-item-icon {{iconClass}}'></div><figcaption>{{title}}</figcaption></div>",subMenuItemTemplate:"<div class='toolbar-sub-menu-nav-item {{iconClass}}'>{{title}}</div>",topLevelItems:[],secondLevelItems:[],expandSpeed:1e3,that:t,easing:"ease-in-out"}},n.fn.init.prototype=n.fn,e.toolbar=n})(window);